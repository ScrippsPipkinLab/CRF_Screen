scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
dim(in.df)
dim(in.df$col)
in.file <- "/Users/yolandatiao/Desktop/CRF_Screen/1_2_normtocontrol_ZP/Compiled_Amt/AAmt_normbycontrolZP_z-score_tsne_per5.csv"
anno_genes <- c("Fbxw9", "Hcfc1", "Hdac1", "Hat1", "Gadd45a", "Hdac6", "Hdac2", "Gtf2f1", "Fkbp1a")
anno_cols <- c("red", "aqua", "teal", "olive", "orange", "purple", "fuchsia", "yellow", "brown")
in.df <- read.csv(in.file)
in.df$col <- sltAnnoCol(in.df, anno_genes, anno_cols)
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
in.df$col <- sltAnnoCols(in.df, anno_genes, anno_cols)
in.df$col
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.8, shape = 19) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
sltAnnoCols <- function(df.x, gene.vec){
new.vec <- character(nrow(df.x))
for (x in 1:nrow(df.x)){
gene.x <- shRNAtoGene(as.character(unlist(df.x$shRNA))[x])
if(gene.x %in% gene.vec){
new.vec[x] <- gene.x
#print(gene.x)
}
else{
new.vec[x] <- "other"
}
}
return(new.vec)
}
anno_cols <- c("red", "aqua", "teal", "olive", "orange", "purple", "fuchsia", "yellow", "brown", "grey")
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.8, shape = 19) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_fill_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot
in.file <- "/Users/yolandatiao/Desktop/CRF_Screen/1_2_normtocontrol_ZP/Compiled_Amt/AAmt_normbycontrolZP_z-score_tsne_per5.csv"
anno_genes <- c("Fbxw9", "Hcfc1", "Hdac1", "Hat1", "Gadd45a", "Hdac6", "Hdac2", "Gtf2f1", "Fkbp1a")
anno_cols <- c("red", "aqua", "teal", "olive", "orange", "purple", "fuchsia", "yellow", "brown", "grey")
in.df <- read.csv(in.file)
in.df$col <- sltAnnoCols(in.df, anno_genes)
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.8, shape = 19) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_fill_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.8, shape = 19) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
anno_cols <- c("red", "aqua", "teal", "olive", "orange", "purple", "maroon1", "yellow", "brown", "grey")
in.df <- read.csv(in.file)
in.df$col <- sltAnnoCols(in.df, anno_genes)
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.8, shape = 19) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
anno_cols <- c("red", "aqua", "mediumturquoise", "olive", "orange", "purple", "maroon1", "yellow", "brown", "grey")
in.df <- read.csv(in.file)
in.df$col <- sltAnnoCols(in.df, anno_genes)
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.8, shape = 19) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
anno_cols <- c("red", "aqua", "mediumturquoise", "olivedrab2", "orange", "purple", "maroon1", "yellow", "brown", "grey")
in.df <- read.csv(in.file)
in.df$col <- sltAnnoCols(in.df, anno_genes)
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.8, shape = 19) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
anno_cols <- c("red", "lightskyblue", "mediumturquoise", "olivedrab2", "orange", "purple", "maroon1", "yellow", "brown", "grey")
in.df <- read.csv(in.file)
in.df$col <- sltAnnoCols(in.df, anno_genes)
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.8, shape = 19) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
sltAnnoSizes <- function(df.x, gene.vec){
new.vec <- character(nrow(df.x))
for (x in 1:nrow(df.x)){
gene.x <- shRNAtoGene(as.character(unlist(df.x$shRNA))[x])
if(gene.x %in% gene.vec){
new.vec[x] <- 10
#print(gene.x)
}
else{
new.vec[x] <- 5
}
}
return(new.vec)
}
in.df$size <- sltAnnoSizes(in.df, anno_genes)
in.df$size
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col, size=in.df$size)) +
geom_point(alpha = 0.8, shape = 19) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
in.df$size
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col, size=in.df$size)) +
geom_point(alpha = 0.8, shape = 19) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
in.file <- "/Users/yolandatiao/Desktop/CRF_Screen/1_2_normtocontrol_ZP/Compiled_Amt/AAmt_normbycontrolZP_z-score_tsne_per5.csv"
anno_genes <- c("Fbxw9", "Hcfc1", "Hdac1", "Hat1", "Gadd45a", "Hdac6", "Hdac2", "Gtf2f1", "Fkbp1a")
anno_cols <- c("red", "lightskyblue", "mediumturquoise", "olivedrab2", "orange", "purple", "maroon1", "yellow", "brown", "grey")
in.df <- read.csv(in.file)
in.df$col <- sltAnnoCols(in.df, anno_genes)
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
in.file <- "/Users/yolandatiao/Desktop/CRF_Screen/1_2_normtocontrol_ZP/Compiled_Amt/AAmt_normbycontrolZP_z-score_tsne_per5.csv"
anno_genes <- c("Fbxw9", "Hcfc1", "Hdac1", "Hat1", "Gadd45a", "Hdac6", "Hdac2", "Gtf2f1", "Fkbp1a")
anno_cols <- c("red", "lightskyblue", "mediumturquoise", "olivedrab2", "orange", "purple", "maroon1", "yellow", "brown", "gray80")
in.df <- read.csv(in.file)
in.df$col <- sltAnnoCols(in.df, anno_genes)
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col, size=in.df$size)) +
geom_point(alpha = 0.6, shape = 19) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.6, shape = 19) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
in.df.anno <- subset(in.df, in.df$anno != "")
in.df.anno
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2)) +
geom_point(alpha = 0.6, shape = 19) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color="gray80")) +
geom_point(alpha = 0.6, shape = 19) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2)) +
geom_point(alpha = 0.6, shape = 19, color="gray80") +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2)) +
geom_point(alpha = 0.6, shape = 19, color="gray80", size = 4) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2)) +
geom_point(alpha = 0.6, shape = 19, color="gray80", size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- cbs.plot +
geom_point(in.df.anno, aes(x=in.df$t1, y=in.df$t2), size = 4)
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2)) +
geom_point(alpha = 0.6, shape = 19, color="gray80", size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot <- cbs.plot + ggplot(in.df.anno, aes(x=in.df.anno$t1, y=in.df.anno$t2), color=in.df.anno$col) +
scale_color_manual(values = anno_cols)
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2)) +
geom_point(alpha = 0.6, shape = 19, color="gray80", size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot <- cbs.plot + ggplot(in.df.anno, aes(x=in.df.anno$t1, y=in.df.anno$t2, color=in.df.anno$col)) +
scale_color_manual(values = anno_cols)
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2)) +
geom_point(alpha = 0.6, shape = 19, color="gray80", size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot <- cbs.plot + geom_point(in.df.anno, aes(x=in.df.anno$t1, y=in.df.anno$t2, color=in.df.anno$col)) +
scale_color_manual(values = anno_cols)
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.6, shape = 19, color="gray80", size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot <- cbs.plot + geom_point(in.df.anno, aes(x=in.df.anno$t1, y=in.df.anno$t2, color=in.df.anno$col)) +
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2),  color=in.df$col) +
geom_point(alpha = 0.6, shape = 19, color="gray80", size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot <- cbs.plot + geom_point(in.df.anno, aes(x=in.df.anno$t1, y=in.df.anno$t2, color=in.df.anno$col)) +
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$anno)) +
geom_point(alpha = 0.6, shape = 19, color="gray80", size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$anno)) +
geom_point(alpha = 0.6, shape = 19, color="gray80", size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot <- cbs.plot + ggplot(in.df.anno, aes(x=in.df.anno$t1, y=in.df.anno$t2), color) +
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$anno)) +
geom_point(alpha = 0.6, shape = 19, color="gray80", size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
in.file <- "/Users/yolandatiao/Desktop/CRF_Screen/1_2_normtocontrol_ZP/Compiled_Amt/AAmt_normbycontrolZP_z-score_tsne_per5.csv"
anno_genes <- c("Fbxw9", "Hcfc1", "Hdac1", "Hat1", "Gadd45a", "Hdac6", "Hdac2", "Gtf2f1", "Fkbp1a")
anno_cols <- c("red", "lightskyblue", "mediumturquoise", "olivedrab2", "orange", "purple", "maroon1", "yellow", "brown", "gray80")
in.df <- read.csv(in.file)
in.df$col <- sltAnnoCols(in.df, anno_genes)
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$anno)) +
geom_point(alpha = 0.6, shape = 19, color="gray80", size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
in.df$col
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.6, shape = 19, color="gray80", size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.6, shape = 19,  size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
in.df <- read.csv(in.file)
in.df$col <- sltAnnoCols(in.df, anno_genes)
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.6, shape = 19,  size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
#in.file <- "/Users/yolandatiao/Desktop/CRF_Screen/1_2_normtocontrol_ZP/Compiled_Amt/AAmt_normbycontrolZP_z-score_tsne_per5.csv"
anno_genes <- c("Fbxw9", "Hcfc1", "Hdac1", "Hat1", "Gadd45a")
anno_cols <- c("red", "lightskyblue", "olivedrab2", "orange", "purple", "gray80")
in.df <- read.csv(in.file)
in.df$col <- sltAnnoCols(in.df, anno_genes)
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.6, shape = 19,  size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
out.name <- paste(anno_genes, collapse="-")
out.name <- paste(out.name, in.file, sep="--")
out.name <- gsub(".csv", ".png", out.name)
out.name
in.file <- "Amt_normbycontrolZP_z-score_tsne_per10.csv"
anno_genes <- c("Fbxw9", "Hcfc1", "Hdac1", "Hat1", "Gadd45a")
anno_cols <- c("red", "lightskyblue", "olivedrab2", "orange", "purple", "gray80")
in.df <- read.csv(in.file)
in.df$col <- sltAnnoCols(in.df, anno_genes)
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2, color=in.df$col)) +
geom_point(alpha = 0.6, shape = 19,  size = 2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
scale_color_manual(values = anno_cols) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
out.name <- paste(anno_genes, collapse="-")
out.name <- paste(out.name, in.file, sep="--")
out.name <- gsub(".csv", ".png", out.name)
out.name
ggsave(out.name, plot = cbs.plot, device = "png", units = "cm", width = 25, height = 25)
setwd("/Users/yolandatiao/Desktop/CRF_Screen/1_2_normtocontrol_ZP/Compiled_Amt")
ggsave(out.name, plot = cbs.plot, device = "png", units = "cm", width = 15, height = 15)
ggsave(out.name, plot = cbs.plot, device = "png", units = "cm", width = 15, height = 12)
source('~/Desktop/CRF_Screen/0_Codes/3_tsne_cbs-plot_byshRNA.R')
wk.dir <- "/Users/yolandatiao/Desktop/CRF_Screen/1_2_normtocontrol_ZP"
setwd(wk.dir)
tsne.per10 <- "Compiled_Amt/AAmt_normbycontrolZP_z-score_tsne_per10.csv"
for (gene in crf.genes) {
gene.vec <- c(gene)
col.vec <- c("red", "gray80")
cbs_plot(tsne.per10, gene.vec, col.vec)
}
tsne.per10 <- "Compiled_Amt/Amt_normbycontrolZP_z-score_tsne_per10.csv"
for (gene in crf.genes) {
gene.vec <- c(gene)
col.vec <- c("red", "gray80")
cbs_plot(tsne.per10, gene.vec, col.vec)
}
gene.vec <- c(gene)
col.vec <- c("red", "gray80")
print(gene.vec)
cbs_plot(tsne.per10, gene.vec, col.vec)
gene.vec <- c(gene,)
col.vec <- c("red", "gray80")
print(gene.vec)
for (gene in crf.genes) {
gene.vec <- c(gene,)
col.vec <- c("red", "gray80")
cbs_plot(tsne.per10, gene.vec, col.vec)
}
gene.vec <- c(gene)
col.vec <- c("red", "gray80")
cbs_plot(tsne.per10, gene.vec, col.vec)
in.file <- "Amt_normbycontrolZP_z-score_tsne_per10.csv"
anno_genes <- c("A1l")
anno_cols <- c("red", "gray80")
in.df <- read.csv(in.file)
in.df$col <- sltAnnoCols(in.df, anno_genes)
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
in.file <- "Amt_normbycontrolZP_z-score_tsne_per10.csv"
anno_genes <- c("A1l")
anno_cols <- c("red", "gray80")
in.df <- read.csv(in.file)
in.df$col <- sltAnnoCols(in.df, anno_genes)
in.df$anno <- sltAnnoGenes(in.df, anno_genes)
in.df <- read.csv(in.file)
source('~/Desktop/CRF_Screen/0_Codes/3_tsne_cbs-plot_byshRNA.R')
source('~/Desktop/CRF_Screen/0_Codes/3_tsne_cbs-plot_byshRNA.R')
wk.dir <- "/Users/yolandatiao/Desktop/CRF_Screen/1_2_normtocontrol_ZP/Compiled_Amt"
setwd(wk.dir)
tsne.per10 <- "Compiled_Amt/Amt_normbycontrolZP_z-score_tsne_per10.csv"
for (gene in crf.genes) {
gene.vec <- c(gene)
col.vec <- c("red", "gray80")
cbs_plot(tsne.per10, gene.vec, col.vec)
}
source('~/Desktop/CRF_Screen/0_Codes/3_tsne_cbs-plot_byshRNA.R')
wk.dir <- "/Users/yolandatiao/Desktop/CRF_Screen/1_2_normtocontrol_ZP/Compiled_Amt"
setwd(wk.dir)
tsne.per10 <- "Amt_normbycontrolZP_z-score_tsne_per10.csv"
for (gene in crf.genes) {
gene.vec <- c(gene)
col.vec <- c("red", "gray80")
cbs_plot(tsne.per10, gene.vec, col.vec)
}
tsne.per5 <- "Amt_normbycontrolZP_z-score_tsne_per10.csv"
for (gene in crf.genes) {
gene.vec <- c(gene)
col.vec <- c("red", "gray80")
cbs_plot(tsne.per5, gene.vec, col.vec)
}
tsne.per5 <- "Amt_normbycontrolZP_z-score_tsne_per5.csv"
for (gene in crf.genes) {
gene.vec <- c(gene)
col.vec <- c("red", "gray80")
cbs_plot(tsne.per5, gene.vec, col.vec)
}
