cbs.plot <- cbs.plot +
layer(data = sub.df, geom="point", position = "identity",
geom_params = list(color="red", alpha=0.8, size=1, shape=19),
stat="identity", mapping=aes(x=sub.df$t1, y=sub.df$t2))
#          geom_params = list(fill = "white", color = "steelblue")
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2)) +
geom_point(alpha = 0.6, shape = 19, color='black', size=0.5) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- cbs.plot +
layer(data = sub.df, geom="point", position = "identity",
geom_params = list(color="red", size=1, shape=19),
stat="identity", mapping=aes(x=sub.df$t1, y=sub.df$t2))
#          geom_params = list(fill = "white", color = "steelblue")
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2)) +
geom_point(alpha = 0.6, shape = 19, color='black', size=0.5) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- cbs.plot +
layer(data = sub.df, geom="point", position = "identity",
geom_params = list(color="red"),
stat="identity", mapping=aes(x=sub.df$t1, y=sub.df$t2))
#          geom_params = list(fill = "white", color = "steelblue")
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2)) +
geom_point(alpha = 0.6, shape = 19, color='black', size=0.5) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- cbs.plot +
layer(data = sub.df, geom="point", position = "identity",
geom_params = list(color="red"),  stat="identity", mapping=aes(x=sub.df$t1, y=sub.df$t2))
#          geom_params = list(fill = "white", color = "steelblue")
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2)) +
geom_point(alpha = 0.6, shape = 19, color='black', size=0.5) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- cbs.plot +
layer(data = sub.df, geom="point", position = "identity",
stat="identity", mapping=aes(x=sub.df$t1, y=sub.df$t2))
#          geom_params = list(fill = "white", color = "steelblue")
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2)) +
geom_point(alpha = 0.6, shape = 19, color='black', size=0.5) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- cbs.plot +
layer(data = sub.df, geom="point", position = "identity",
stat="identity", mapping=aes(x=sub.df$t1, y=sub.df$t2, color="red"))
#          geom_params = list(fill = "white", color = "steelblue")
cbs.plot
cbs.plot <- ggplot(in.df, aes(x=in.df$t1, y=in.df$t2)) +
geom_point(alpha = 0.6, shape = 19, color='black', size=0.5) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
cbs.plot
cbs.plot <- cbs.plot +
layer(data = sub.df, geom="point", position = "identity",
stat="identity", mapping=aes(x=sub.df$t1, y=sub.df$t2, color="red", alpha=0.8))
#          geom_params = list(fill = "white", color = "steelblue")
cbs.plot
out.name <- gsub(".csv","_", out.appx, ".pdf", in.file)
out.name
out.name <- gsub(".csv","_", out.appx, ".pdf", in.file)
out.name
out.name <- gsub(".csv",".pdf", in.file)
out.name
out.name <- gsub(".csv","", in.file)
out.name
out.name <- paste(out.name, "_", out.appx, ".pdf")
out.name
# Save without annotation
out.name <- gsub(".csv","", in.file)
out.name <- paste(out.name, "_", out.appx, ".pdf", sep="")
out.name
out.csv.name <- gsub(".csv", "", in.file)
out.csv.name <- paste(out.csv.name, "_", out.appx, ".csv", sep="")
out.csv.name
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
in_file <- "/Volumes/Yolanda/CRF_Screen/InVitro/2_0_t-test_by_gene/compiled_Amt/Amt_normbycontrolZP_t-test.by.geneavg_z-score_tsne_per5.csv"
slt_list <- c('Prmt7', 'Rnf20', 'Rbbp4')
out_appx <- "test"
cbs_plot(in_file, slt_list, out_appx)
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
in_file <- "/Volumes/Yolanda/CRF_Screen/InVitro/2_0_t-test_by_gene/compiled_Amt/Amt_normbycontrolZP_t-test.by.geneavg_z-score_tsne_per5.csv"
slt_list <- c('Prmt7', 'Rnf20', 'Rbbp4')
out_appx <- "test"
in.file <- in_file
slt.list <- slt_list
out.appx <- out_appx
in.df <- read.csv(in.file)
in.df <- slt_anno(in.df)
sub.df <- subset(in.df, in.df$gene_name %in% slt.list)
in.file <- in_file
slt.list <- slt_list
out.appx <- out_appx
#in.file <- '/Volumes/Yolanda/CRF_Screen/InVitro/2_0_t-test_by_gene/compiled_Amt/tsne-per5_cbs-plot/CD127GeoMean_100U _tsnf-z-p.csv'
#slt.list <- c('Prmt7', 'Rnf20', 'Rbbp4')
#out.appx <- 'slt'
in.df <- read.csv(in.file)
sub.df <- subset(in.df, in.df$gene_name %in% slt.list)
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
in_file <- "/Volumes/Yolanda/CRF_Screen/InVitro/2_0_t-test_by_gene/compiled_Amt/Amt_normbycontrolZP_t-test.by.geneavg_z-score_tsne_per5.csv"
in_df <- read.csv(in.file)
slt_df <- subset(in_df, in_df$t2>50)
slt_df$gene_name
slt_df <- subset(in_df, in_df$t2>50)
slt_df$gene_name
in_df$gene_name
unlist(slt_df$gene_name)
as.character(unlist(slt_df$gene_name))
###----- Group1
slt_df <- subset(in_df, in_df$t2>50)
g1_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g1_list, out_appx="g1")
slt_df <- subset(in_df, in_df$t2>50)
g1_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g1_list, "g1")
###----- Group2
slt_df <- subset(in_df, (in_df$t1>50)&(in_df$t2<0))
g2_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g2_list, "g2")
###----- Group3
slt_df <- subset(in_df, in_df$t1<-70)
g3_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g3_list, "g3")
###----- Group3
slt_df <- subset(in_df, in_df$t1<-70)
g3_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g3_list, "g3")
###----- Group3
slt_df <- subset(in_df, in_df$t1 < -70)
g3_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g3_list, "g3")
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
###----- Group5
slt_df <- subset(in_df, in_df$t2 < -30)
g5_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g5_list, "g5")
###----- Group6
slt_df <- subset(in_df, (in_df$t1 > -25)&(in_df$t1 <20)&(in_df$t2<0))
g6_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g6_list, "g6")
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
###----- Group7
slt_df <- subset(in_df, (in_df$t1 > 50)&(in_df$t2> 0))
g7_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g7_list, "g7")
###----- Group8
slt_df <- subset(in_df, (in_df$t1 > 30)&(in_df$t< 50))
g8_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g8_list, "g8")
slt_df <- subset(in_df, (in_df$t1 > 30)&(in_df$t< 50))
g8_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g8_list, "g8")
slt_df
###----- Group8
slt_df <- subset(in_df, (in_df$t1 > 30)&(in_df$t1< 50))
g8_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g8_list, "g8")
###----- Group8
slt_df <- subset(in_df, (in_df$t1 > 30)&(in_df$t1< 50)&(in_df$t2<25))
g8_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g8_list, "g8")
###----- Group9
slt_df <- subset(in_df, (in_df$t1 < 30)&(in_df$t1 > 20)&(in_df$t2<25))
g9_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g9_list, "g9")
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
slt_df <- subset(in_df, (in_df$t1 < 50)&(in_df$t1 > 10)&(in_df$t2<50)&(in_df$t2>25))
g10_list <- unlist(slt_df$gene_name)
cbs_plot(in_file, g10_list, "g10")
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
all.plot <- ggplot(in.df, aes(x=in_df$t1, y=in_df$t2)) +
geom_point(alpha = 0.6, shape = 19, color='black', size=2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
all.plot
for (x in c(1:10)){
print(x)
}
list_slt <- list(g1_list, g2_list, g3_list, g4_list, g5_list,
g6_list, g7_list, g8_list, g9_list, g10_list)
str(list_slt)
g1_list
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
tab_list[1]$t1
tab_list[1]
for (x in c(1:10)){
tabx <- tab_list[x]
all.plot <- all.plot +
layer(data = tabx, geom="point", position = "identity",
stat="identity", mapping=aes(x=tabx$t1, y=tabx$t2, color=color_list[x], alpha=0.8, size=2))
}
cbs.plot
all.plot
x <- 1
tabx <- tab_list[x]
all.plot <- all.plot +
layer(data = tabx, geom="point", position = "identity",
stat="identity", mapping=aes(x=tabx$t1, y=tabx$t2, color=color_list[x], alpha=0.8, size=2))
tabx$t1
tab_list[1]
class(tab_list[1])
as.data.frame(class(tab_list[1]))
as.data.frame(tab_list[1])
as.data.frame(tab_list[1])$t1
for (x in c(1:10)){
tabx <- as.data.frame(tab_list[x])
all.plot <- all.plot +
layer(data = tabx, geom="point", position = "identity",
stat="identity", mapping=aes(x=tabx$t1, y=tabx$t2, color=color_list[x], alpha=0.8, size=2))
}
all.plot
###----- Plot all
all.plot <- ggplot(in.df, aes(x=in_df$t1, y=in_df$t2)) +
geom_point(alpha = 0.6, shape = 19, color='black', size=2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
list_slt <- list(g1_list, g2_list, g3_list, g4_list, g5_list,
g6_list, g7_list, g8_list, g9_list, g10_list)
tab_list <- list(slt_df1, slt_df2, slt_df3, slt_df4, slt_df5,
slt_df6, slt_df7, slt_df8, slt_df9, slt_df10)
color_list <- c("dodgerblue1", "firebrick1","limegreen","orange","slateblue",
"turquoise1", "yellow","tan4","black", "palevioletred1")
all.plot
x <- 1
tabx <- as.data.frame(tab_list[x])
all.plot <- all.plot +
layer(data = tabx, geom="point", position = "identity",
stat="identity", mapping=aes(x=tabx$t1, y=tabx$t2, color=color_list[x], alpha=0.8, size=2))
all.plot
x <- 2
tabx <- as.data.frame(tab_list[x])
all.plot <- all.plot +
layer(data = tabx, geom="point", position = "identity",
stat="identity", mapping=aes(x=tabx$t1, y=tabx$t2, color=color_list[x], alpha=0.8, size=2))
all.plot
tabx
nrow(tabx)
all.plot
all.plot <- ggplot(in.df, aes(x=in_df$t1, y=in_df$t2)) +
geom_point(alpha = 0.6, shape = 19, color='black', size=2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
x <- 2
tabx <- as.data.frame(tab_list[x])
nrow(tabx)
all.plot <- all.plot +
layer(data = tabx, geom="point", position = "identity",
stat="identity", mapping=aes(x=tabx$t1, y=tabx$t2, color=color_list[x], alpha=0.8, size=2))
all.plot
rep("red", 2)
slt_df1$colors <- rep(group_colors[1], nrow(slt_df1))
group_colors <- c("dodgerblue1", "firebrick1","limegreen","orange","slateblue",
"turquoise1", "yellow","tan4","black", "palevioletred1")
slt_df1$colors <- rep(group_colors[1], nrow(slt_df1))
slt_df1$colors <- rep(group_colors[1], nrow(slt_df1))
slt_df2$colors <- rep(group_colors[2], nrow(slt_df2))
slt_df3$colors <- rep(group_colors[3], nrow(slt_df3))
slt_df4$colors <- rep(group_colors[4], nrow(slt_df4))
slt_df5$colors <- rep(group_colors[5], nrow(slt_df5))
slt_df6$colors <- rep(group_colors[6], nrow(slt_df6))
slt_df7$colors <- rep(group_colors[7], nrow(slt_df7))
slt_df8$colors <- rep(group_colors[8], nrow(slt_df8))
slt_df9$colors <- rep(group_colors[9], nrow(slt_df9))
slt_df10$colors <- rep(group_colors[10], nrow(slt_df10))
all_df <- rbind(slt_df1, slt_df2, slt_df3, slt_df4, slt_df5,
slt_df6, slt_df7, slt_df8, slt_df9, slt_df10)
all_df$colors
all_plot <- ggplot(all_df, aes(x=all_df$t1, y=all_df$t2, color=all_df$colors)) +
geom_point(alpha = 0.6, shape = 19, size=2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
all_plot
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
group_colors <- c("dodgerblue1", "firebrick1","darkslateblue","orange","slateblue",
"turquoise1", "yellow","tan4","black", "palevioletred1")
slt_df1$colors <- rep(group_colors[1], nrow(slt_df1))
slt_df2$colors <- rep(group_colors[2], nrow(slt_df2))
slt_df3$colors <- rep(group_colors[3], nrow(slt_df3))
slt_df4$colors <- rep(group_colors[4], nrow(slt_df4))
slt_df5$colors <- rep(group_colors[5], nrow(slt_df5))
slt_df6$colors <- rep(group_colors[6], nrow(slt_df6))
slt_df7$colors <- rep(group_colors[7], nrow(slt_df7))
slt_df8$colors <- rep(group_colors[8], nrow(slt_df8))
slt_df9$colors <- rep(group_colors[9], nrow(slt_df9))
slt_df10$colors <- rep(group_colors[10], nrow(slt_df10))
all_df <- rbind(slt_df1, slt_df2, slt_df3, slt_df4, slt_df5,
slt_df6, slt_df7, slt_df8, slt_df9, slt_df10)
all_plot <- ggplot(all_df, aes(x=all_df$t1, y=all_df$t2, color=all_df$colors)) +
geom_point(alpha = 0.6, shape = 19, size=2) +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
all_plot
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
ggsave("all_groups.pdf", plot = all_plot, device = "pdf", units = "cm", width = 25, height = 25)
setwd("/Volumes/Yolanda/CRF_Screen/InVitro/2_0_t-test_by_gene/compiled_Amt")
ggsave("all_groups.pdf", plot = all_plot, device = "pdf", units = "cm", width = 25, height = 25)
all_plot <- ggplot(all_df, aes(x=all_df$t1, y=all_df$t2, color=all_df$colors)) +
geom_point(alpha = 0.6, shape = 19, size=2, color="black") +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
all_plot
all_plot <- ggplot(all_df, aes(x=all_df$t1, y=all_df$t2, color=all_df$colors)) +
geom_point(alpha = 0.6, shape = 19, size=2, color="black") +
scale_x_continuous(limits = c(-100, 100)) +
scale_y_continuous(limits = c(-100, 100)) +
theme(panel.background = element_rect(fill = "white", colour = "white",size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid', colour = "grey"),
panel.grid.minor = element_line(size = 0.15, linetype = 'solid',colour = "grey"),
text = element_text(size=10))
all_plot
setwd("/Volumes/Yolanda/CRF_Screen/InVitro/2_0_t-test_by_gene/compiled_Amt")
ggsave("al.pdf", plot = all_plot, device = "pdf", units = "cm", width = 25, height = 25)
group_lists <- list(g1_list, g2_list, g3_list, g4_list, g5_list,
g6_list, g7_list, g8_list, g9_list, g10_list)
#####---------- Pathway analysis
group_lists <- list(g1_list, g2_list, g3_list, g4_list, g5_list,
g6_list, g7_list, g8_list, g9_list, g10_list)
i <- 1
genes.i <- group_lists[i]
genes.i
i <- 1
genes.i <- as.character(unlist(group_lists[i]))
genes.i
genes.i <- as.character(unlist(group_lists[i]))
egoBP <- enrichGO(gene = genes.i, keyType = 'gene_name', OrgDb = org.Hs.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
egoBP <- enrichGO(gene = genes.i, keyType = 'gene_symbol', OrgDb = org.Hs.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
genes.i <- as.character(unlist(group_lists[i]))
egoBP <- enrichGO(gene = genes.i, keyType = 'genename', OrgDb = org.Hs.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
i <- 1
genes.i <- as.character(unlist(group_lists[i]))
egoBP <- enrichGO(gene = genes.i, keyType = 'genename', OrgDb = org.Mm.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
source ("https://bioconductor.org/biocLite.R")
biocLite("org.Mm.eg.db")
library("clusterProfiler")
i <- 1
genes.i <- as.character(unlist(group_lists[i]))
egoBP <- enrichGO(gene = genes.i, keyType = 'genename', OrgDb = org.Mm.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
BiocManager::install("org.Mm.eg.db")
library("org.Mm.eg.db")
i <- 1
genes.i <- as.character(unlist(group_lists[i]))
egoBP <- enrichGO(gene = genes.i, keyType = 'genename', OrgDb = org.Mm.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
egoBP <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Mm.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
i <- 1
genes.i <- as.character(unlist(group_lists[i]))
egoBP <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Mm.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
str(egoBP)
for (i in c(1:len(group_lists))) {
setwd("/Volumes/Yolanda/CRF_Screen/InVitro/2_0_t-test_by_gene/compiled_Amt")
genes.i <- as.character(unlist(group_lists[i]))
egoBP <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Mm.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
egoCC <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Hs.eg.db, ont = "CC", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
egoMF <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Hs.eg.db, ont = "MF", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
# Dotplot visualization
egoBP.dotplot <- dotplot(egoBP, showCategory=25)
ggsave(paste(i,"_BP_dotplot.pdf",sep=""), egoBP.dotplot, device = "pdf", width = 30, height = 20, units = "cm")
egoCC.dotplot <- dotplot(egoCC, showCategory=25)
ggsave(paste(i,"_CC_dotplot.pdf",sep=""), egoCC.dotplot, device = "pdf", width = 30, height = 20, units = "cm")
egoMF.dotplot <- dotplot(egoMF, showCategory=25)
ggsave(paste(i,"_MF_dotplot.pdf",sep=""), egoMF.dotplot, device = "pdf", width = 30, height = 20, units = "cm")
}
for (i in c(1:length(group_lists))) {
setwd("/Volumes/Yolanda/CRF_Screen/InVitro/2_0_t-test_by_gene/compiled_Amt")
genes.i <- as.character(unlist(group_lists[i]))
egoBP <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Mm.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
egoCC <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Hs.eg.db, ont = "CC", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
egoMF <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Hs.eg.db, ont = "MF", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
# Dotplot visualization
egoBP.dotplot <- dotplot(egoBP, showCategory=25)
ggsave(paste(i,"_BP_dotplot.pdf",sep=""), egoBP.dotplot, device = "pdf", width = 30, height = 20, units = "cm")
egoCC.dotplot <- dotplot(egoCC, showCategory=25)
ggsave(paste(i,"_CC_dotplot.pdf",sep=""), egoCC.dotplot, device = "pdf", width = 30, height = 20, units = "cm")
egoMF.dotplot <- dotplot(egoMF, showCategory=25)
ggsave(paste(i,"_MF_dotplot.pdf",sep=""), egoMF.dotplot, device = "pdf", width = 30, height = 20, units = "cm")
}
source('/Volumes/Yolanda/CRF_Screen/0_Codes/3_tsne_cbs-plot_byGene_groups.R')
for (i in c(1:length(group_lists))) {
setwd("/Volumes/Yolanda/CRF_Screen/InVitro/2_0_t-test_by_gene/compiled_Amt")
genes.i <- as.character(unlist(group_lists[i]))
egoBP <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Mm.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
egoCC <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Mm.eg.db, ont = "CC", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
egoMF <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Mm.eg.db, ont = "MF", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
# Dotplot visualization
egoBP.dotplot <- dotplot(egoBP, showCategory=25)
ggsave(paste(i,"_BP_dotplot.pdf",sep=""), egoBP.dotplot, device = "pdf", width = 30, height = 20, units = "cm")
egoCC.dotplot <- dotplot(egoCC, showCategory=25)
ggsave(paste(i,"_CC_dotplot.pdf",sep=""), egoCC.dotplot, device = "pdf", width = 30, height = 20, units = "cm")
egoMF.dotplot <- dotplot(egoMF, showCategory=25)
ggsave(paste(i,"_MF_dotplot.pdf",sep=""), egoMF.dotplot, device = "pdf", width = 30, height = 20, units = "cm")
}
for (i in c(1:length(group_lists))) {
setwd("/Volumes/Yolanda/CRF_Screen/InVitro/2_0_t-test_by_gene/compiled_Amt")
genes.i <- as.character(unlist(group_lists[i]))
print(genes.i)
}
for (i in c(1:length(group_lists))) {
setwd("/Volumes/Yolanda/CRF_Screen/InVitro/2_0_t-test_by_gene/compiled_Amt")
genes.i <- as.character(unlist(group_lists[i]))
print(length(genes.i))
}
for (i in c(1:length(group_lists))) {
setwd("/Volumes/Yolanda/CRF_Screen/InVitro/2_0_t-test_by_gene/compiled_Amt")
genes.i <- as.character(unlist(group_lists[i]))
egoBP <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Mm.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
egoCC <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Mm.eg.db, ont = "CC", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
egoMF <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Mm.eg.db, ont = "MF", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
# Dotplot visualization
egoBP.dotplot <- dotplot(egoBP, showCategory=25)
ggsave(paste(i,"_BP_dotplot.pdf",sep=""), egoBP.dotplot, device = "pdf", width = 30, height = 20, units = "cm")
egoCC.dotplot <- dotplot(egoCC, showCategory=25)
ggsave(paste(i,"_CC_dotplot.pdf",sep=""), egoCC.dotplot, device = "pdf", width = 30, height = 20, units = "cm")
egoMF.dotplot <- dotplot(egoMF, showCategory=25)
ggsave(paste(i,"_MF_dotplot.pdf",sep=""), egoMF.dotplot, device = "pdf", width = 30, height = 20, units = "cm")
}
if (NULL){
print("yes")
}
x <- NULL
if (x==NULL){
print("yes")
}
x <- NULL
if (x){
print("yes")
}
x <- NULL
if (is.nan(x)){
print("yes")
}
x
x <- NULL
if (is.null(x)){
print("yes")
}
x <- NULL
if (!is.null(x)){
print("yes")
}
genes.i <- as.character(unlist(all_df$gene_name))
egoBP <- enrichGO(gene = genes.i, keyType = 'GENENAME', OrgDb = org.Mm.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
egoBP <- enrichGO(gene = genes.i, keyType = 'SYMBOL', OrgDb = org.Mm.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
egoBP
length(genes.i)
genes.i
genes.i <- c("Prmt1",    "Prmt2",    "Prmt3",    "Prmt5",    "Prmt6")
egoBP <- enrichGO(gene = genes.i, keyType = 'SYMBOL', OrgDb = org.Mm.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
genes.i <- all_df$gene_name
egoBP <- enrichGO(gene = genes.i, keyType = 'SYMBOL', OrgDb = org.Mm.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)
all_df$gene_name
