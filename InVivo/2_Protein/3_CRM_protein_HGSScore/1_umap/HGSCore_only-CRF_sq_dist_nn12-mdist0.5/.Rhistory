z.tab$Q4minusQ1_cor <- tbColor(z.tab$Q4minusQ1)
z.tab$Q3minusOther_cor <- tbColor(z.tab$Q3minusOther)
z.tab$InputMinusAvg_cor <- tbColor(z.tab$InputMinusAvg)
# Annotate genes by complexes
coor.tab <- coor.tab %>%
left_join(anno.tab, by="gene_name")
coor.tab$gene_name <- cvtGNames(coor.tab$gene_name)
coor.tab <- coor.tab %>%
left_join(z.tab, by = "gene_name") %>%
mutate(Q4minusQ1 = replace_na(Q4minusQ1, 0)) %>%
mutate(Q3minusOther = replace_na(Q3minusOther, 0)) %>%
mutate(InputMinusAvg = replace_na(InputMinusAvg, 0)) %>%
mutate(Q4minusQ1_cor = replace_na(Q4minusQ1_cor, "middle")) %>%
mutate(Q3minusOther_cor = replace_na(Q3minusOther_cor, "middle")) %>%
mutate(InputMinusAvg_cor = replace_na(InputMinusAvg_cor, "middle"))
coor.tab$tsp <- tspGene(coor.tab$complexNames, highlightTerms, tspDot)
coor.tab$bd <- rep(0, nrow(coor.tab))
coor.tab$annonames <- sltAnno(coor.tab$gene_name, coor.tab$complexNames, highlightTerms)
coor.tab$Q4minusQ1_cor <- factor(coor.tab$Q4minusQ1_cor, levels=c("top", "bottom", "middle"))
coor.tab$Q3minusOther_cor <- factor(coor.tab$Q3minusOther_cor, levels=c("top", "bottom", "middle"))
coor.tab$InputMinusAvg_cor <- factor(coor.tab$InputMinusAvg_cor, levels=c("top", "bottom", "middle"))
# Annotate edge tibble, add coordiate and transparency
edge.tab <- edgeCoor(edge.tab, coor.tab, tspEdge)
outName <- "InputMinusAvg_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=InputMinusAvg_cor, size=5, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=1.5) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 25, height = 20, units = "cm")
coorFile <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_coor.csv"
edgeFile <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_nn_dupr.csv"
annoFile <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein/3_CRM_protein_HGSScore/1_umap/HGSCore_only-CRF_anno.csv"
ZScoreFile<- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/all_z-score_div_sqrt-p_sqrt.csv"
edgeFilter <- 0.6
highlightTerms <- c("SET-MLL", "MOZ-MORF")
outName <- "networkplot.anno.pdf"
# Set transparency
tspEdge <- 0.5
tspDot <- 1
outName2 <- gsub(".pdf", "_ref.csv", outName)
termCols <- c("tomato","deepskyblue", "gray20")
# Read coordinates and edge files
coor.tab <- read_csv(coorFile)
edge.tab <- read_csv(edgeFile) %>% filter(val > edgeFilter)
anno.tab <- read_csv(annoFile)
z.tab <- read_csv(ZScoreFile) %>% mutate(gene_name = toupper(gene_name))
# Mark top and bottom genes
z.tab$Q4minusQ1_cor <- tbColor(z.tab$Q4minusQ1)
z.tab$Q3minusOther_cor <- tbColor(z.tab$Q3minusOther)
z.tab$InputMinusAvg_cor <- tbColor(z.tab$InputMinusAvg)
# Annotate genes by complexes
coor.tab <- coor.tab %>%
left_join(anno.tab, by="gene_name")
coor.tab$gene_name <- cvtGNames(coor.tab$gene_name)
coor.tab <- coor.tab %>%
left_join(z.tab, by = "gene_name") %>%
mutate(Q4minusQ1 = replace_na(Q4minusQ1, 0)) %>%
mutate(Q3minusOther = replace_na(Q3minusOther, 0)) %>%
mutate(InputMinusAvg = replace_na(InputMinusAvg, 0)) %>%
mutate(Q4minusQ1_cor = replace_na(Q4minusQ1_cor, "middle")) %>%
mutate(Q3minusOther_cor = replace_na(Q3minusOther_cor, "middle")) %>%
mutate(InputMinusAvg_cor = replace_na(InputMinusAvg_cor, "middle"))
coor.tab$gene_name
coorFile <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_coor.csv"
edgeFile <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_nn_dupr.csv"
annoFile <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein/3_CRM_protein_HGSScore/1_umap/HGSCore_only-CRF_anno.csv"
ZScoreFile<- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/all_z-score_div_sqrt-p_sqrt.csv"
edgeFilter <- 0.6
highlightTerms <- c("SET-MLL", "MOZ-MORF")
outName <- "networkplot.anno.pdf"
# Set transparency
tspEdge <- 0.5
tspDot <- 1
outName2 <- gsub(".pdf", "_ref.csv", outName)
termCols <- c("tomato","deepskyblue", "gray20")
# Read coordinates and edge files
coor.tab <- read_csv(coorFile)
edge.tab <- read_csv(edgeFile) %>% filter(val > edgeFilter)
anno.tab <- read_csv(annoFile)
z.tab <- read_csv(ZScoreFile) %>% mutate(gene_name = toupper(gene_name))
# Mark top and bottom genes
z.tab$Q4minusQ1_cor <- tbColor(z.tab$Q4minusQ1)
z.tab$Q3minusOther_cor <- tbColor(z.tab$Q3minusOther)
z.tab$InputMinusAvg_cor <- tbColor(z.tab$InputMinusAvg)
# Annotate genes by complexes
coor.tab <- coor.tab %>%
left_join(anno.tab, by="gene_name")
coor.tab$gene_name <- cvtGNames(coor.tab$gene_name)
coor.tab$gene_name
coorFile <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_coor.csv"
edgeFile <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_nn_dupr.csv"
annoFile <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein/3_CRM_protein_HGSScore/1_umap/HGSCore_only-CRF_anno.csv"
ZScoreFile<- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/all_z-score_div_sqrt-p_sqrt.csv"
edgeFilter <- 0.6
highlightTerms <- c("SET-MLL", "MOZ-MORF")
outName <- "networkplot.anno.pdf"
# Set transparency
tspEdge <- 0.5
tspDot <- 1
outName2 <- gsub(".pdf", "_ref.csv", outName)
termCols <- c("tomato","deepskyblue", "gray20")
# Read coordinates and edge files
coor.tab <- read_csv(coorFile)
edge.tab <- read_csv(edgeFile) %>% filter(val > edgeFilter)
anno.tab <- read_csv(annoFile)
z.tab <- read_csv(ZScoreFile) %>% mutate(gene_name = toupper(gene_name))
# Mark top and bottom genes
z.tab$Q4minusQ1_cor <- tbColor(z.tab$Q4minusQ1)
z.tab$Q3minusOther_cor <- tbColor(z.tab$Q3minusOther)
z.tab$InputMinusAvg_cor <- tbColor(z.tab$InputMinusAvg)
coor.tab$gene_name
coor.tab <- coor.tab %>%
left_join(anno.tab, by="gene_name")
coor.tab$gene_name
coor.tab$gene_name <- cvtGNames(coor.tab$gene_name)
coor.tab$gene_name
gnList <- c("KAT6A")
inList <- c("KDM8", "KAT8", "KAT7", "KAT6B", "KAT6A")
outList <- c("JMJD5", "MYST1", "MYST2", "MYST4", "MYST3")
newList <- character(length(gnList))
for (i in c(1: length(gnList))){
if (gnList[i] %in% inList){
idxi <- match(i, inList)
newList[i] <- outList[idxi]
}
else{
newList[i] <- gnList[i]
}
}
newList
gnList <- c("KAT6A")
inList <- c("KDM8", "KAT8", "KAT7", "KAT6B", "KAT6A")
outList <- c("JMJD5", "MYST1", "MYST2", "MYST4", "MYST3")
newList <- character(length(gnList))
for (i in c(1: length(gnList))){
if (gnList[i] %in% inList){
idxi <- match(i, inList)
print(idxi)
newList[i] <- outList[idxi]
}
else{
newList[i] <- gnList[i]
}
}
gnList <- c("KAT6A")
inList <- c("KDM8", "KAT8", "KAT7", "KAT6B", "KAT6A")
outList <- c("JMJD5", "MYST1", "MYST2", "MYST4", "MYST3")
newList <- character(length(gnList))
for (i in c(1: length(gnList))){
print(gnList[i])
if (gnList[i] %in% inList){
idxi <- match(i, inList)
print(idxi)
newList[i] <- outList[idxi]
}
else{
newList[i] <- gnList[i]
}
}
gnList <- c("KAT6A")
inList <- c("KDM8", "KAT8", "KAT7", "KAT6B", "KAT6A")
outList <- c("JMJD5", "MYST1", "MYST2", "MYST4", "MYST3")
newList <- character(length(gnList))
for (i in c(1: length(gnList))){
print(gnList[i])
if (gnList[i] %in% inList){
idxi <- match(i, inList)
print(idxi)
newList[i] <- outList[idxi]
}
else{
print(gnList[i])
newList[i] <- gnList[i]
}
}
i <- 1
print(gnList[i])
i <- 1
print(gnList[i])
if (gnList[i] %in% inList){
idxi <- match(i, inList)
newList[i] <- outList[idxi]
}
else{
newList[i] <- gnList[i]
}
for (i in c(1: length(gnList))){
i <- 1
print(gnList[i])
if (gnList[i] %in% inList){
idxi <- match(i, inList)
newList[i] <- outList[idxi]
}
else{
newList[i] <- gnList[i]
}
}
gnList[i] %in% inList
cvtGNames <- function(gnList){
inList <- c("KDM8", "KAT8", "KAT7", "KAT6B", "KAT6A")
outList <- c("JMJD5", "MYST1", "MYST2", "MYST4", "MYST3")
newList <- character(length(gnList))
for (i in c(1: length(gnList))){
if (gnList[i] %in% inList){
idxi <- match(gnList[i], inList)
newList[i] <- outList[idxi]
}
else{
newList[i] <- gnList[i]
}
}
return(newList)
}
coorFile <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_coor.csv"
edgeFile <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_nn_dupr.csv"
annoFile <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein/3_CRM_protein_HGSScore/1_umap/HGSCore_only-CRF_anno.csv"
ZScoreFile<- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/all_z-score_div_sqrt-p_sqrt.csv"
edgeFilter <- 0.6
highlightTerms <- c("SET-MLL", "MOZ-MORF")
outName <- "networkplot.anno.pdf"
# Set transparency
tspEdge <- 0.5
tspDot <- 1
outName2 <- gsub(".pdf", "_ref.csv", outName)
termCols <- c("tomato","deepskyblue", "gray20")
# Read coordinates and edge files
coor.tab <- read_csv(coorFile)
edge.tab <- read_csv(edgeFile) %>% filter(val > edgeFilter)
anno.tab <- read_csv(annoFile)
z.tab <- read_csv(ZScoreFile) %>% mutate(gene_name = toupper(gene_name))
# Mark top and bottom genes
z.tab$Q4minusQ1_cor <- tbColor(z.tab$Q4minusQ1)
z.tab$Q3minusOther_cor <- tbColor(z.tab$Q3minusOther)
z.tab$InputMinusAvg_cor <- tbColor(z.tab$InputMinusAvg)
# Annotate genes by complexes
coor.tab <- coor.tab %>%
left_join(anno.tab, by="gene_name")
coor.tab$gene_name <- cvtGNames(coor.tab$gene_name)
coor.tab <- coor.tab %>%
left_join(z.tab, by = "gene_name") %>%
mutate(Q4minusQ1 = replace_na(Q4minusQ1, 0)) %>%
mutate(Q3minusOther = replace_na(Q3minusOther, 0)) %>%
mutate(InputMinusAvg = replace_na(InputMinusAvg, 0)) %>%
mutate(Q4minusQ1_cor = replace_na(Q4minusQ1_cor, "middle")) %>%
mutate(Q3minusOther_cor = replace_na(Q3minusOther_cor, "middle")) %>%
mutate(InputMinusAvg_cor = replace_na(InputMinusAvg_cor, "middle"))
coor.tab$gene_name
coor.tab$tsp <- tspGene(coor.tab$complexNames, highlightTerms, tspDot)
coor.tab$bd <- rep(0, nrow(coor.tab))
coor.tab$annonames <- sltAnno(coor.tab$gene_name, coor.tab$complexNames, highlightTerms)
coor.tab$Q4minusQ1_cor <- factor(coor.tab$Q4minusQ1_cor, levels=c("top", "bottom", "middle"))
coor.tab$Q3minusOther_cor <- factor(coor.tab$Q3minusOther_cor, levels=c("top", "bottom", "middle"))
coor.tab$InputMinusAvg_cor <- factor(coor.tab$InputMinusAvg_cor, levels=c("top", "bottom", "middle"))
# Annotate edge tibble, add coordiate and transparency
edge.tab <- edgeCoor(edge.tab, coor.tab, tspEdge)
outName <- "InputMinusAvg_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=InputMinusAvg_cor, size=5, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=1.5) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 25, height = 20, units = "cm")
outName <- "Q4minusQ1_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=Q4minusQ1_cor, size=5, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=1.5) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 25, height = 20, units = "cm")
outName <- "Q3minusOther_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=Q3minusOther_cor, size=5, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=1.5) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 25, height = 20, units = "cm")
outName <- "Q3minusOther_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=Q3minusOther_cor, size=5, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=1.5) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 12, height = 9, units = "cm")
outName <- "Q3minusOther_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=Q3minusOther_cor, size=5, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=1.5) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 12, height = 9, units = "cm")
outName <- "Q3minusOther_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=Q3minusOther_cor, size=5, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=1.5) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 15, height = 12, units = "cm")
outName <- "Q3minusOther_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=Q3minusOther_cor, size=5, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=1.5) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 16, height = 12, units = "cm")
outName <- "Q3minusOther_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=Q3minusOther_cor, size=5, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=1.5) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 16, height = 11, units = "cm")
outName <- "Q3minusOther_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=Q3minusOther_cor, size=3, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=1.5) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 16, height = 11, units = "cm")
outName <- "Q3minusOther_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=Q3minusOther_cor, size=3, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=2) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 16, height = 11, units = "cm")
coorFile <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_coor.csv"
edgeFile <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_nn_dupr.csv"
annoFile <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein/3_CRM_protein_HGSScore/1_umap/HGSCore_only-CRF_anno.csv"
ZScoreFile<- "/Volumes/Yolanda/CRF_Screen/InVivo/1_1_Norm/20190516/5_zscore_div_sqrt_pval/all_z-score_div_sqrt-p_sqrt.csv"
edgeFilter <- 0.6
highlightTerms <- c("SET-MLL", "MOZ-MORF")
outName <- "networkplot.anno.pdf"
# Set transparency
tspEdge <- 0.5
tspDot <- 0.9
outName2 <- gsub(".pdf", "_ref.csv", outName)
termCols <- c("tomato","deepskyblue", "gray20")
# Read coordinates and edge files
coor.tab <- read_csv(coorFile)
edge.tab <- read_csv(edgeFile) %>% filter(val > edgeFilter)
anno.tab <- read_csv(annoFile)
z.tab <- read_csv(ZScoreFile) %>% mutate(gene_name = toupper(gene_name))
# Mark top and bottom genes
z.tab$Q4minusQ1_cor <- tbColor(z.tab$Q4minusQ1)
z.tab$Q3minusOther_cor <- tbColor(z.tab$Q3minusOther)
z.tab$InputMinusAvg_cor <- tbColor(z.tab$InputMinusAvg)
# Annotate genes by complexes
coor.tab <- coor.tab %>%
left_join(anno.tab, by="gene_name")
coor.tab$gene_name <- cvtGNames(coor.tab$gene_name)
coor.tab <- coor.tab %>%
left_join(z.tab, by = "gene_name") %>%
mutate(Q4minusQ1 = replace_na(Q4minusQ1, 0)) %>%
mutate(Q3minusOther = replace_na(Q3minusOther, 0)) %>%
mutate(InputMinusAvg = replace_na(InputMinusAvg, 0)) %>%
mutate(Q4minusQ1_cor = replace_na(Q4minusQ1_cor, "middle")) %>%
mutate(Q3minusOther_cor = replace_na(Q3minusOther_cor, "middle")) %>%
mutate(InputMinusAvg_cor = replace_na(InputMinusAvg_cor, "middle"))
coor.tab$gene_name
coor.tab$tsp <- tspGene(coor.tab$complexNames, highlightTerms, tspDot)
coor.tab$bd <- rep(0, nrow(coor.tab))
coor.tab$annonames <- sltAnno(coor.tab$gene_name, coor.tab$complexNames, highlightTerms)
coor.tab$Q4minusQ1_cor <- factor(coor.tab$Q4minusQ1_cor, levels=c("top", "bottom", "middle"))
coor.tab$Q3minusOther_cor <- factor(coor.tab$Q3minusOther_cor, levels=c("top", "bottom", "middle"))
coor.tab$InputMinusAvg_cor <- factor(coor.tab$InputMinusAvg_cor, levels=c("top", "bottom", "middle"))
# Annotate edge tibble, add coordiate and transparency
edge.tab <- edgeCoor(edge.tab, coor.tab, tspEdge)
outName <- "Q3minusOther_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=Q3minusOther_cor, size=3, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=2) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 16, height = 11, units = "cm")
outName <- "$Q4minusQ1_cor_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=Q4minusQ1_cor, size=3, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=2) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 16, height = 11, units = "cm")
outName <- "$Q4minusQ1_cor_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=Q4minusQ1_cor, size=3, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=2) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 16, height = 11, units = "cm")
outName <- "Q4minusQ1_cor_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=Q4minusQ1_cor, size=3, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=2) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 16, height = 11, units = "cm")
outName <- "Q4minusQ1_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=Q4minusQ1_cor, size=3, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=2) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 16, height = 11, units = "cm")
outName <- "InputMinusAvg_color.pdf"
# Plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=InputMinusAvg_cor, size=3, alpha=tsp, stroke=coor.tab$bd)) +
scale_color_manual(values=termCols) +
geom_text_repel(data=coor.tab, aes(x=x, y=y, label=coor.tab$annonames), force=2) +
theme(panel.border = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
#sc.plot
ggsave(outName, sc.plot, device = 'pdf', width = 16, height = 11, units = "cm")
