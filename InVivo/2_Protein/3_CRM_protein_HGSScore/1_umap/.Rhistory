coor.file <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_coor.csv"
edge.file <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_nn_dupr.csv"
coor.tab <- read_csv(coor.file)
edge.tab <- read_csv(edge.file)
terms.anno <- c("SWI/SNF complex", "NuRD complex", "MLL1 complex", "Set1C/COMPASS complex")
terms.names <- c("SWISNF", "NuRD", "MLL1", "Set1cCompass")
terms.cols <- c("firebrick1", "deepskyblue", "limegreen", "goldenrod1")
anno.colors <- annoColor(coor.tab$gene_name, terms.anno, terms.names, terms.cols)
coor.tab$colors <- anno.colors
sc.plot <- ggplot(coor.tab, aes(x=x, y=y), colorcolors) + geom_point()
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y), color=colors) + geom_point()
sc.plot
coor.tab$colors
coor.tab$anno_col <- anno.colors
sc.plot <- ggplot(coor.tab, aes(x=x, y=y), color=anno_col) + geom_point()
sc.plot
sc.plot <- NULL
sc.plot <- ggplot(coor.tab, aes(x=x, y=y), color=anno_col)
+ geom_point()
sc.plot <- ggplot(coor.tab, aes(x=x, y=y), color=anno_col) +
geom_point()
sc.plot
coor.tab
sc.plot <- ggplot(coor.tab, aes(x=x, y=y, color=anno_col)) +
geom_point()
sc.plot
findGoGenes <- function(term_name){
ref_go_file <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein/2_GO_terms/CRM_complexes_count.csv"
ref_go_tab <- read_csv(ref_go_file)
ref_go_tab$gene_name <- toupper(ref_go_tab$gene_name)
slt_cols <- c("gene_name",term_name)
colNums <- match(slt_cols,names(ref_go_tab))
ref_go_tab <- ref_go_tab %>%
select(colNums)
ref_go_tab <- ref_go_tab %>%
rename_at(vars(colnames(ref_go_tab)), ~ c("gene_name", "term_name")) %>%
filter(term_name == "Yes")
return(ref_go_tab)
}
annoColor <- function(all_genes, term_vector, term_newname, col_vector){
#term_vector <- c("SWI/SNF complex", "NuA4 histone acetyltransferase complex")
#term_newname <- c("SWISNF", "NuA4")
#col_vector <- c("red", "blue")
#all_genes <- coor.tab$gene_name
gene_tb <- tibble(gene_name = all_genes)
for (i in c(1: length(term_vector))){
term <- term_vector[i]
term_tb <- findGoGenes(term)
term_tb <- term_tb %>% rename(!!term_newname[i] := term_name)
gene_tb <- gene_tb %>% left_join(term_tb)
}
slice(gene_tb, 1)
gene_cols <- character(length(all_genes))
complex <- character(length(all_genes))
for (i in c(1: nrow(gene_tb))){
row_i <- unlist(slice(gene_tb, i), use.names=FALSE)[1:length(term_vector)+1]
col_true <- 0
for (j in c(1: length(term_vector))){
if (!is.na(row_i[j])){
col_true <- col_true + 1
if (col_true == 1){
gene_cols[i] = col_vector[j]
complex[i] = term_newname[j]
}
else{
gene_cols[i] = "black"
complex[i] = "multi"
print(slice(gene_tb, i)[1])
}
}
}
if (col_true == 0){
gene_cols[i] = "grey"
complex[i] = "other"
}
}
return(list(gene_cols, complex))
}
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein/3_CRM_protein_HGSScore/1_umap"
setwd(wk.dir)
coor.file <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_coor.csv"
edge.file <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_nn_dupr.csv"
coor.tab <- read_csv(coor.file)
edge.tab <- read_csv(edge.file)
terms.anno <- c("SWI/SNF complex", "NuRD complex", "MLL1 complex", "Set1C/COMPASS complex")
terms.names <- c("SWISNF", "NuRD", "MLL1", "Set1cCompass")
terms.cols <- c("firebrick1", "deepskyblue", "limegreen", "goldenrod1")
annos <- annoColor(coor.tab$gene_name, terms.anno, terms.names, terms.cols)
coor.tab$complex <- annos[1]
coor.tab$anno_col <- annos[2]
coor.tab$complex
annos
annos[1]
annos[1][1]
unlist(annos[1])
#################### Main ####################
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein/3_CRM_protein_HGSScore/1_umap"
setwd(wk.dir)
coor.file <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_coor.csv"
edge.file <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_nn_dupr.csv"
coor.tab <- read_csv(coor.file)
edge.tab <- read_csv(edge.file)
terms.anno <- c("SWI/SNF complex", "NuRD complex", "MLL1 complex", "Set1C/COMPASS complex")
terms.names <- c("SWISNF", "NuRD", "MLL1", "Set1cCompass")
terms.cols <- c("firebrick1", "deepskyblue", "limegreen", "goldenrod1")
annos <- annoColor(coor.tab$gene_name, terms.anno, terms.names, terms.cols)
coor.tab$complex <- unlist(annos[2])
coor.tab$anno_col <- unlist(annos[1])
coor.tab$complex
sc.plot <- ggplot(coor.tab, aes(x=x, y=y, color=anno_complex)) +
geom_point()
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y, color=complex)) +
geom_point()
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y, color=complex)) +
geom_point() +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y, color=complex)) +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3)) +
geom_point() +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y, color=complex)) +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3, color = "black", size=0.5)) +
geom_point() +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y, color=complex)) +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3, color = "black")) +
geom_point() +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot() +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3, color = "black"))
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y, color=complex)) +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3, color = "black")) +
geom_point() +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y)) +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3)) +
geom_point(color=complex) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- NULL
sc.plot <- ggplot(coor.tab, aes(x=x, y=y)) +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3)) +
geom_point(color=complex) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y)) +
geom_point(color=complex) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1")) +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3))
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y)) +
geom_point(color=complex) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1")) +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3))
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y, color=complex)) +
geom_point() +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1")) +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3))
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y, color=complex)) +
geom_point() +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1")) +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3, color="black"))
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y, color=complex)) +
geom_point() +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1")) +
sc.plot <- sc.plot +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3))
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y, color=complex)) +
geom_point() +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot <- sc.plot +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3))
sc.plot
sc.plot <- ggplot(coor.tab, aes(x=x, y=y, color=complex)) +
geom_point() +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot <- sc.plot +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3, color="black"))
sc.plot
sc.plot <- ggplot() +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3))
sc.plot <- sc.plot +
geom_point(coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot <- ggplot() +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3))
sc.plot <- sc.plot +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot() +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3, color="black"))
sc.plot <- sc.plot +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot() +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3, alpha=0.7))
sc.plot <- sc.plot +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot() +
geom_segment(aes(x = 5, y = 5, xend = 3, yend = 3, alpha=0.5))
sc.plot <- sc.plot +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
edge.tab
edge.tab <- read_csv(edge.file)
edge.tab
edge.tab <- read_csv(edge.file) %>% filter(val > 0.5)
sc.plot <- ggplot()
for (i in c(1:nrow(edge.tab))){
idx1.i <- edge.tab$idx1[i] + 1
idx2.i <- edge.tab$idx2[i] + 1
idx1.i.x <- unlist(slice(gene_tb, idx1.i), use.names=FALSE)[1]
idx1.i.y <- unlist(slice(gene_tb, idx1.i), use.names=FALSE)[1]
idx2.i.x <- unlist(slice(gene_tb, idx2.i), use.names=FALSE)[1]
idx2.i.y <- unlist(slice(gene_tb, idx2.i), use.names=FALSE)[1]
sc.plot <- sc.plot +
geom_segment(aes(x = idx1.i.x, y = idx1.i.y, xend = idx2.i.x, yend = idx2.i.y, alpha=0.5))
}
sc.plot <- sc.plot +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot()
for (i in c(1:nrow(edge.tab))){
idx1.i <- edge.tab$idx1[i] + 1
idx2.i <- edge.tab$idx2[i] + 1
idx1.i.x <- unlist(slice(gene_tb, idx1.i), use.names=FALSE)[1]
idx1.i.y <- unlist(slice(gene_tb, idx1.i), use.names=FALSE)[1]
idx2.i.x <- unlist(slice(gene_tb, idx2.i), use.names=FALSE)[1]
idx2.i.y <- unlist(slice(gene_tb, idx2.i), use.names=FALSE)[1]
sc.plot <- sc.plot +
geom_segment(aes(x = idx1.i.x, y = idx1.i.y, xend = idx2.i.x, yend = idx2.i.y, alpha=0.5))
}
sc.plot
sc.plot <- ggplot()
for (i in c(1:nrow(edge.tab))){
idx1.i <- edge.tab$idx1[i] + 1
idx2.i <- edge.tab$idx2[i] + 1
idx1.i.x <- unlist(slice(gene_tb, idx1.i), use.names=FALSE)[2]
idx1.i.y <- unlist(slice(gene_tb, idx1.i), use.names=FALSE)[3]
idx2.i.x <- unlist(slice(gene_tb, idx2.i), use.names=FALSE)[2]
idx2.i.y <- unlist(slice(gene_tb, idx2.i), use.names=FALSE)[3]
sc.plot <- sc.plot +
geom_segment(aes(x = idx1.i.x, y = idx1.i.y, xend = idx2.i.x, yend = idx2.i.y, alpha=0.5))
}
sc.plot
sc.plot <- ggplot()
for (i in c(1:nrow(edge.tab))){
idx1.i <- edge.tab$idx1[i] + 1
idx2.i <- edge.tab$idx2[i] + 1
idx1.i.x <- unlist(slice(gene_tb, idx1.i), use.names=FALSE)[2]
idx1.i.y <- unlist(slice(gene_tb, idx1.i), use.names=FALSE)[3]
idx2.i.x <- unlist(slice(gene_tb, idx2.i), use.names=FALSE)[2]
idx2.i.y <- unlist(slice(gene_tb, idx2.i), use.names=FALSE)[3]
print(idx1.i.x)
}
unlist(slice(coor.tab, 1), use.names=FALSE)
sc.plot <- ggplot()
for (i in c(1:nrow(edge.tab))){
idx1.i <- edge.tab$idx1[i] + 1
idx2.i <- edge.tab$idx2[i] + 1
idx1.i.x <- unlist(slice(coor.tab, idx1.i), use.names=FALSE)[2]
idx1.i.y <- unlist(slice(coor.tab, idx1.i), use.names=FALSE)[3]
idx2.i.x <- unlist(slice(coor.tab, idx2.i), use.names=FALSE)[2]
idx2.i.y <- unlist(slice(coor.tab, idx2.i), use.names=FALSE)[3]
sc.plot <- sc.plot +
geom_segment(aes(x = idx1.i.x, y = idx1.i.y, xend = idx2.i.x, yend = idx2.i.y, alpha=0.5))
}
sc.plot
for (i in c(1:nrow(edge.tab))){
idx1.i <- edge.tab$idx1[i] + 1
idx2.i <- edge.tab$idx2[i] + 1
idx1.i.x <- unlist(slice(coor.tab, idx1.i), use.names=FALSE)[2]
idx1.i.y <- unlist(slice(coor.tab, idx1.i), use.names=FALSE)[3]
idx2.i.x <- unlist(slice(coor.tab, idx2.i), use.names=FALSE)[2]
idx2.i.y <- unlist(slice(coor.tab, idx2.i), use.names=FALSE)[3]
print(idx1.i.x)
}
edge.tab <- read_csv(edge.file) %>% filter(val > 0.5)
nrow(edge.tab)
edge.tab <- read_csv(edge.file) %>% filter(val > 0.7)
nrow(edge.tab)
edge.tab <- read_csv(edge.file) %>% filter(val > 0.8)
nrow(edge.tab)
edge.tab <- read_csv(edge.file) %>% filter(val > 0.9)
nrow(edge.tab)
sc.plot <- ggplot()
for (i in c(1:nrow(edge.tab))){
idx1.i <- edge.tab$idx1[i] + 1
idx2.i <- edge.tab$idx2[i] + 1
idx1.i.x <- unlist(slice(coor.tab, idx1.i), use.names=FALSE)[2]
idx1.i.y <- unlist(slice(coor.tab, idx1.i), use.names=FALSE)[3]
idx2.i.x <- unlist(slice(coor.tab, idx2.i), use.names=FALSE)[2]
idx2.i.y <- unlist(slice(coor.tab, idx2.i), use.names=FALSE)[3]
sc.plot <- sc.plot +
geom_segment(aes(x = idx1.i.x, y = idx1.i.y, xend = idx2.i.x, yend = idx2.i.y, alpha=0.5))
}
sc.plot
idx1x <- numeric(nrow(edge.tab))
idx1y <- numeric(nrow(edge.tab))
idx2x <- numeric(nrow(edge.tab))
idx2y <- numeric(nrow(edge.tab))
for (i in c(1:nrow(edge.tab))){
idx1.i <- edge.tab$idx1[i] + 1
idx2.i <- edge.tab$idx2[i] + 1
idx1.i.x <- unlist(slice(coor.tab, idx1.i), use.names=FALSE)[2]
idx1.i.y <- unlist(slice(coor.tab, idx1.i), use.names=FALSE)[3]
idx2.i.x <- unlist(slice(coor.tab, idx2.i), use.names=FALSE)[2]
idx2.i.y <- unlist(slice(coor.tab, idx2.i), use.names=FALSE)[3]
idx1x[i] <- idx1.i.x
idx1y[i] <- idx1.i.y
idx2x[i] <- idx2.i.x
idx2y[i] <- idx2.i.y
}
edge.tab$idx1x <- idx1x
edge.tab$idx1y <- idx1y
edge.tab$idx2x <- idx1x
edge.tab$idx2y <- idx2y
sc.plot <- ggplot()
sc.plot <- sc.plot +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=0.5))
sc.plot
edge.tab$idx1x
sc.plot <- ggplot(edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=0.5)) +
geom_segment(data=edge.tab)
sc.plot
edge.tab$idx1x <- idx1x
edge.tab$idx1y <- idx1y
edge.tab$idx2x <- idx2x
edge.tab$idx2y <- idx2y
sc.plot <- ggplot(edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=0.5)) +
geom_segment(data=edge.tab)
sc.plot
sc.plot <- sc.plot +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=0.5))
sc.plot <- sc.plot +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
coor.tab$x
edge.tab$idx1x
sc.plot <- sc.plot +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1")) +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=0.5))
sc.plot
sc.plot <- NULL
sc.plot <- sc.plot +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot() +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot() +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1")) +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=0.5))
sc.plot
edge.tab$idx1x
idx1x <- numeric(nrow(edge.tab))
idx1y <- numeric(nrow(edge.tab))
idx2x <- numeric(nrow(edge.tab))
idx2y <- numeric(nrow(edge.tab))
for (i in c(1:nrow(edge.tab))){
idx1.i <- edge.tab$idx1[i] + 1
idx2.i <- edge.tab$idx2[i] + 1
idx1.i.x <- unlist(slice(coor.tab, idx1.i), use.names=FALSE)[2]
idx1.i.y <- unlist(slice(coor.tab, idx1.i), use.names=FALSE)[3]
idx2.i.x <- unlist(slice(coor.tab, idx2.i), use.names=FALSE)[2]
idx2.i.y <- unlist(slice(coor.tab, idx2.i), use.names=FALSE)[3]
idx1x[i] <- as.numeric(idx1.i.x)
idx1y[i] <- as.numeric(idx1.i.y)
idx2x[i] <- as.numeric(idx2.i.x)
idx2y[i] <- as.numeric(idx2.i.y)
}
edge.tab$idx1x <- idx1x
edge.tab$idx1y <- idx1y
edge.tab$idx2x <- idx2x
edge.tab$idx2y <- idx2y
edge.tab$idx1x
sc.plot <- ggplot() +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1")) +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=0.5))
sc.plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=0.5)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, size=0.5)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, size=0.01)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex, size=5)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
wk.dir <- "/Volumes/Yolanda/CRF_Screen/InVivo/2_Protein/3_CRM_protein_HGSScore/1_umap"
setwd(wk.dir)
coor.file <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_coor.csv"
edge.file <- "HGSCore_only-CRF_sq_dist_nn12-mdist0.5_nn_dupr.csv"
coor.tab <- read_csv(coor.file)
edge.tab <- read_csv(edge.file) %>% filter(val > 0.7)
terms.anno <- c("SWI/SNF complex", "NuRD complex", "MLL1 complex", "Set1C/COMPASS complex")
terms.names <- c("SWISNF", "NuRD", "MLL1", "Set1cCompass")
#terms.cols <- c("firebrick1", "deepskyblue", "limegreen", "goldenrod1")
annos <- annoColor(coor.tab$gene_name, terms.anno, terms.names, terms.cols)
coor.tab$complex <- unlist(annos[2])
#coor.tab$anno_col <- unlist(annos[1])
idx1x <- numeric(nrow(edge.tab))
idx1y <- numeric(nrow(edge.tab))
idx2x <- numeric(nrow(edge.tab))
idx2y <- numeric(nrow(edge.tab))
for (i in c(1:nrow(edge.tab))){
idx1.i <- edge.tab$idx1[i] + 1
idx2.i <- edge.tab$idx2[i] + 1
idx1.i.x <- unlist(slice(coor.tab, idx1.i), use.names=FALSE)[2]
idx1.i.y <- unlist(slice(coor.tab, idx1.i), use.names=FALSE)[3]
idx2.i.x <- unlist(slice(coor.tab, idx2.i), use.names=FALSE)[2]
idx2.i.y <- unlist(slice(coor.tab, idx2.i), use.names=FALSE)[3]
idx1x[i] <- as.numeric(idx1.i.x)
idx1y[i] <- as.numeric(idx1.i.y)
idx2x[i] <- as.numeric(idx2.i.x)
idx2y[i] <- as.numeric(idx2.i.y)
}
edge.tab$idx1x <- idx1x
edge.tab$idx1y <- idx1y
edge.tab$idx2x <- idx2x
edge.tab$idx2y <- idx2y
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex, size=5)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
ggsave("networkplot", sc.plot, device = pdf, width = 10, height = 10, units = "cm")
ggsave("networkplot", sc.plot, device = 'pdf', width = 10, height = 10, units = "cm")
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex, size=5, alpha=0.7)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
ggsave("networkplot", sc.plot, device = 'pdf', width = 50, height = 40, units = "cm")
ggsave("networkplot.pdf", sc.plot, device = 'pdf', width = 50, height = 40, units = "cm")
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex, size=5, alpha=0.7)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
ggsave("networkplot.pdf", sc.plot, device = 'pdf', width = 25, height = 20, units = "cm")
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y)) +
annotate('segment', alpha = 0.5) +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex, size=5, alpha=0.7)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
ggsave("networkplot.pdf", sc.plot, device = 'pdf', width = 25, height = 20, units = "cm")
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y)) +
annotate('segment', alpha = 0.5) +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex, size=5, alpha=0.7)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y)) +
annotate('segment', alpha = 0.5) +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex, size=5, alpha=0.7)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
sc.plot
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y)) +
annotate('segment', alpha = 0.3) +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex, size=5, alpha=0.7)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
#sc.plot
ggsave("networkplot.pdf", sc.plot, device = 'pdf', width = 25, height = 20, units = "cm")
rep(0.5, 10)
edge.tab$tsp <- rep(0.5, nrow(edge.tab))
edge.tab$tsp <- rep(0.5, nrow(edge.tab))
sc.plot <- ggplot() +
geom_segment(data=edge.tab, aes(x = idx1x, y = idx1y, xend = idx2x, yend = idx2y, alpha=tsp)) +
geom_point(data=coor.tab, aes(x=x, y=y, color=complex, size=5, alpha=0.7)) +
scale_color_manual(values=c("firebrick1","black", "deepskyblue", "grey", "limegreen", "goldenrod1"))
#sc.plot
ggsave("networkplot.pdf", sc.plot, device = 'pdf', width = 25, height = 20, units = "cm")
